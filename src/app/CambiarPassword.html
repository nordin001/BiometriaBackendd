<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cambiar Contraseña</title>

   <!-- Font Icon -->
   <link rel="stylesheet" href="../fonts/material-icon/css/material-design-iconic-font.min.css">

   <!-- Main css -->
   <link rel="stylesheet" href="../css/login_registro.css">
   <link rel="stylesheet" href="../css/style.css" />
   <link href="../css/navbar.css" rel="stylesheet" />
   <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&amp;display=swap" data-tag="font" />
   <link rel="stylesheet" href="../fonts/material-icon/css/material-design-iconic-font.min.css">
   <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

   <!-- Include Stylesheets -->
   <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body onload="comprobarsesionusuario()">

<!-- Sign in Form -->
<div class="main">
    <!-- Header Section -->
    <header data-role="Header" class="page-header">
        <!-- Logo -->
        <a href="index.html">
            <img alt="logo" src="../imagen/logosinnombre15i1597-3rmf-1500h.png" class="page-image" />
        </a>

        <!-- Navigation Links -->
        <div class="page-nav">
            <a href="index.html" class="page-text">Mapa</a>
            <a href="informacion.html" class="page-text01">Más Información</a>
            <a href="sobreNosotros.html" class="page-text02">Sobre Nosotros</a>
        </div>

        <!-- Buttons -->
        <div class="page-btn-group">
            <button class="page-login button"><a href="registroCodo.html">Registrarse</a></button>
            <button class="page-register button">
            <span class="page-text03">
              <a href="InicioSesion.html"> Iniciar Sesión</a>
              <br />
            </span>
            </button>
        </div>

        <!-- Burger Menu Icon -->
        <div data-role="BurgerMenu" class="page-burger-menu">
            <svg viewBox="0 0 1024 1024" class="page-icon">
                <path d="M128 554.667h768c23.552 0 42.667-19.115 42.667-42.667s-19.115-42.667-42.667-42.667h-768c-23.552 0-42.667 19.115-42.667 42.667s19.115 42.667 42.667 42.667zM128 298.667h768c23.552 0 42.667-19.115 42.667-42.667s-19.115-42.667-42.667-42.667h-768c-23.552 0-42.667 19.115-42.667 42.667s19.115 42.667 42.667 42.667zM128 810.667h768c23.552 0 42.667-19.115 42.667-42.667s-19.115-42.667-42.667-42.667h-768c-23.552 0-42.667 19.115-42.667 42.667s19.115 42.667 42.667 42.667z"></path>
            </svg>
        </div>
    </header>

    <!-- Mobile Menu -->
    <div data-role="MobileMenu" class="page-mobile-menu">
        <div class="page-nav1">
            <div class="page-container1">
                <a href="index.html">
                    <img alt="logo" src="../imagen/logosinnombre15i1597-3rmf-1500h.png" class="page-image" />
                </a>          <div data-role="CloseMobileMenu" class="page-menu-close">
                <svg viewBox="0 0 1024 1024" class="page-icon2">
                    <path d="M810 274l-238 238 238 238-60 60-238-238-238 238-60-60 238-238-238-238 60-60 238 238 238-238z"></path>
                </svg>
            </div>
            </div>
            <a href="index.html" class="page-text06">Mapa</a>
            <a href="informacion.html" class="page-text07">Más Información</a>
            <a href="sobreNosotros.html" class="page-text08">Sobre Nosotros</a>
            <a href="registroCodo.html" class="page-text09">Registrarse</a>
            <a href="InicioSesion.html" class="page-text10">Iniciar Sesión</a>
        </div>
    </div>
</div>


    <section class="sign-in">
        <div class="container">
            <div class="signin-content">
                <div class="signin-image">
                    <figure><img src="../imagen/contraseña.svg" alt="sign up image"></figure>
                    <a href="Perfil.html" class="signup-image-link">Volver a Perfil</a>
                </div>
                <div class="signin-form">
                    <h2 >Cambiar Contraseña</h2>
                    <div id="textillo">
                        <a>Cambia tu contraseña regularmente para una experiencia en línea más segura.</a>
                    </div>
                    <form method="POST" class="register-form" id="login-form">
                        <div class="form-group">
                            <label for="contrasenyaactual"><i class="zmdi zmdi-lock "></i></label>
                            <input type="text" name="contrasenyaactual" id="contrasenyaactual" placeholder="Contraseña actual"/>
                        </div>
                        <div class="form-group">
                            <label for="nuevacontrasenya"><i class="zmdi zmdi-lock"></i></label>
                            <input type="text" name="nuevacontrasenya" id="nuevacontrasenya" placeholder="Nueva contraseña"/>
                        </div>
                        <div class="form-group">
                            <label for="confirmarcontrasenya"><i class="zmdi zmdi-lock"></i></label>
                            <input type="text" name="confirmarcontrasenya" id="confirmarcontrasenya" placeholder="Confirmar contraseña"/>
                        </div>
                        <div class="form-group form-button">
                            <input type="button" name="signin" id="signin" class="form-submit" value="Cambiar contraseña" onclick="cambiarContrasenya()"/>
                        </div>
                    </form>

                </div>
            </div>
        </div>
    </section>
</div>
<!-- JS -->
<!--<script src="vendor/jquery/jquery.min.js"></script>-->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="./js/server.js"></script>

<script>
    // Función para comprobar la sesión
    async function comprobarSesion() {
        const userId = await obtenerUserId();
        if(userId!=null)
        return true;
        else
        return false;
    }
  
    // Función para cerrar la sesión
  
    // Función para actualizar la interfaz del header según la sesión
    async function actualizarInterfaz() {
      const botonIniciarSesion = document.querySelector('.page-text03 a');
      const botonRegistrarse = document.querySelector('.page-login a');
      const textoRegistrarseMobile = document.querySelector('.page-text09');
      const textoIniciarSesionMobile = document.querySelector('.page-text10');
      const enlaceMapa = document.querySelector('.page-text');

      if (await comprobarSesion()) {
        // Usuario autenticado
        botonIniciarSesion.textContent = 'Cerrar Sesión';
        botonRegistrarse.innerHTML = '<i class="fas fa-user" style="color: #333333; font-size: larger; margin-right: 5px; vertical-align: middle;"></i> ';
        botonRegistrarse.href = 'perfil.html';
  
        // Actualizar textos en el navbar responsive
        textoRegistrarseMobile.innerHTML = '<i class="fas fa-user" style="color: #333333; font-size: larger; margin-right: 5px; vertical-align: middle;"></i> Perfil';
        textoRegistrarseMobile.href = 'perfil.html';
        textoIniciarSesionMobile.textContent = 'Cerrar Sesión';
        botonIniciarSesion.href = "../api/cerrarsesion.php";
  
        // Cambiar la dirección del enlace "Mapa"
        enlaceMapa.href = 'Index.html';
      } else {
        // Usuario no autenticado
        botonIniciarSesion.textContent = 'Iniciar Sesión';
        botonIniciarSesion.href = 'InicioSesion.html';
        botonRegistrarse.innerHTML = 'Registrarse';
        botonRegistrarse.href = 'registroCodo.html';
  
        // Restaurar textos en el navbar responsive
        textoRegistrarseMobile.innerHTML = 'Registrarse';
        textoRegistrarseMobile.href = 'registroCodo.html';
        textoIniciarSesionMobile.textContent = 'Iniciar Sesión';
        textoIniciarSesionMobile.href = 'InicioSesion.html';
  
        // Restaurar la dirección del enlace "Mapa"
        enlaceMapa.href = 'index.html';
      }
    }
    // Llama a la función para actualizar la interfaz cuando se cargue la página
    document.addEventListener('DOMContentLoaded', actualizarInterfaz);
  </script>
</body>
</html>
